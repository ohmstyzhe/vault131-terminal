:root{
  --g:#4cff9a;

  /* 4:3 tuning */
  --crtMaxW: 1100px;

  /* Screen shape */
  --screenRadius: 22px;
  --lipRadius: 18px;

  /* Realism knobs */
  --glass: 0.95;
  --grime: 0.55;
  --dust: 0.40;
  --noise: 0.14;
  --vignette: 0.95;

  /* Tube feel */
  --bulge: 1; /* 0.7 subtle / 1 stronger */
}

*{ box-sizing:border-box; }

html, body{
  margin:0;
  height:100%;
  background:#000;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

/* =========================
   CRT SHELL (frame)
   ========================= */
#crt{
  width: min(var(--crtMaxW), 96vw);
  aspect-ratio: 4 / 3;
  height: auto;
  max-height: 86svh;
  min-height: 520px;

  background:#050b07;
  border-radius:22px;
  padding:22px;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;

  border:3px solid rgba(76,255,154,0.35);
  box-shadow:
    0 0 45px rgba(76,255,154,0.22),
    inset 0 0 160px rgba(0,0,0,0.96);

  filter: brightness(1.02) contrast(1.14) saturate(1.12);
  transform: translateZ(0);
}

/* =========================
   SCREEN (this is the “monitor glass area”)
   This is where your circled “border around the screen” comes from.
   ========================= */
#screen{
  position:relative;
  flex:1;
  min-height:0;
  border-radius: var(--screenRadius);
  overflow:hidden;
  padding: 16px;

  /* inset + tube depth */
  background:
    radial-gradient(120% 85% at 50% 40%,
      rgba(76,255,154,0.09),
      rgba(0,0,0,0.0) 44%),
    radial-gradient(120% 95% at 50% 55%,
      rgba(0,0,0,0.18),
      rgba(0,0,0,0.82) 70%,
      rgba(0,0,0,0.96) 100%),
    #020503;

  box-shadow:
    inset 0 0 0 2px rgba(76,255,154,0.18),
    inset 0 0 45px rgba(0,0,0,0.75),
    inset 0 0 140px rgba(0,0,0,0.90);

  /* Slight 3D “poking out” */
  transform:
    perspective(1200px)
    rotateX(calc(0.55deg * var(--bulge)))
    rotateY(calc(-0.45deg * var(--bulge)))
    scale(1.002);
}

/* Screen bezel lip (the “computer border around it”) */
#screen::before{
  content:"";
  position:absolute;
  inset: 10px;
  border-radius: var(--lipRadius);
  pointer-events:none;
  z-index: 2;

  /* This is the “plastic lip + inner frame” look */
  box-shadow:
    inset 0 0 0 2px rgba(76,255,154,0.20),
    inset 0 0 22px rgba(0,0,0,0.65),
    inset 0 0 80px rgba(0,0,0,0.80);

  opacity:0.95;
}

/* Extra edge thickness shading (tube corners) */
#screen::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 3;

  background:
    radial-gradient(circle at 50% 48%,
      rgba(0,0,0,0.00) 52%,
      rgba(0,0,0,0.30) 78%,
      rgba(0,0,0,0.70) 100%);

  mix-blend-mode: multiply;
  opacity: 0.75;
}

/* =========================
   CONTENT WARP (text/images feel like they sit on the tube)
   Safe version: slight blur + optional SVG filter
   ========================= */
#tube{
  position:relative;
  z-index: 1;
  min-height:0;
  display:flex;
  flex-direction:column;

  /* This is the “not flat” feel */
  transform: perspective(1400px) rotateX(0.35deg) scale(0.998);
  filter: blur(0.12px) contrast(1.02);

  /* Optional actual warp (works in many browsers; if Safari ignores it, no harm) */
  filter: url(#tubeCurve);
}

/* =========================
   HEADER
   ========================= */
#uiWrap{
  position:relative;
  z-index: 1;
  margin-bottom:10px;
  padding-bottom:10px;
  border-bottom:1px solid rgba(76,255,154,0.3);
}

#uiTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}

#uiBar{
  color:var(--g);
  font-size:14px;
  letter-spacing:1px;
  opacity:0.92;
}

#uiStatus{
  margin-top:6px;
  color:rgba(76,255,154,0.85);
  font-size:12px;
  letter-spacing:0.8px;
  opacity:0.9;
}

/* =========================
   TERMINAL
   ========================= */
#terminal{
  flex:1;
  min-height:0;
  overflow-y:auto;
  overflow-x:hidden;
  color:var(--g);
  white-space:pre-wrap;

  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;

  /* Phosphor bloom */
  text-shadow:
    0 0 4px rgba(76,255,154,0.72),
    0 0 12px rgba(76,255,154,0.30),
    1px 0 0 rgba(255, 180, 90, 0.08),
    -1px 0 0 rgba(120, 255, 210, 0.06);
}

/* =========================
   INPUT
   ========================= */
#inputBox{
  display:none;
  width:80%;
  margin-top:10px;
  background:rgba(0,0,0,0.6);
  color:var(--g);
  border:2px solid var(--g);
  padding:10px;
  border-radius:10px;
  font-size:16px;
  outline:none;
}

#hintContainer{
  margin-top:6px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}

/* =========================
   BUTTONS
   ========================= */
#crt button{
  -webkit-appearance:none;
  appearance:none;
  background:transparent;
  color:var(--g);
  border:2px solid rgba(76,255,154,0.55);
  border-radius:10px;
  padding:10px 14px;
  cursor:pointer;
  font:inherit;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
  box-shadow:0 0 12px rgba(76,255,154,0.12);
  transition: box-shadow .15s ease, border-color .15s ease, transform .08s ease, filter .15s ease;
}
#crt button:hover,
#crt button:focus-visible{
  border-color: rgba(76,255,154,0.95);
  box-shadow:
    0 0 10px rgba(76,255,154,0.30),
    0 0 18px rgba(76,255,154,0.20),
    inset 0 0 10px rgba(76,255,154,0.12);
  filter: brightness(1.12);
}
#crt button:active{ transform: translateY(1px); }
#crt button:focus{ outline:none; }

/* =========================
   FX LAYERS (bound to #screen)
   ========================= */
#scanlines{
  position:absolute;
  inset:10px;
  border-radius: var(--lipRadius);
  background:repeating-linear-gradient(
    to bottom,
    rgba(0,0,0,.30), rgba(0,0,0,.30) 1px,
    transparent 1px, transparent 3px
  );
  pointer-events:none;
  animation: scan 2s linear infinite;
  z-index: 10;
  opacity:0.68;
  mix-blend-mode: overlay;
}
@keyframes scan {from{background-position:0 0;}to{background-position:0 3px;}}

#powerDip{
  position:absolute;
  inset:10px;
  border-radius: var(--lipRadius);
  background:radial-gradient(circle at 50% 45%,
    rgba(76,255,154,0.10),
    rgba(0,0,0,0.92) 60%,
    rgba(0,0,0,0.98) 100%);
  opacity:0;
  pointer-events:none;
  z-index: 12;
  mix-blend-mode:screen;
}
.powerDipOn{ animation: dip 420ms ease-in-out 1; }
@keyframes dip{
  0%{opacity:0; filter:brightness(1) contrast(1);}
  20%{opacity:0.9; filter:brightness(0.65) contrast(1.25);}
  55%{opacity:0.35; filter:brightness(0.85) contrast(1.15);}
  100%{opacity:0; filter:brightness(1) contrast(1);}
}

.projectorBand{
  position:absolute;
  inset:-30% -10%;
  pointer-events:none;
  z-index: 11;
  background: linear-gradient(
    to bottom,
    rgba(255, 210, 140, 0.00) 0%,
    rgba(255, 210, 140, 0.035) 45%,
    rgba(255, 210, 140, 0.00) 65%
  );
  opacity:0.45;
  transform: translateY(-60%);
  animation: projectorBandMove 5.6s linear infinite;
  mix-blend-mode: screen;
}
@keyframes projectorBandMove{
  0%{ transform: translateY(-60%); }
  100%{ transform: translateY(60%); }
}

/* =========================
   THICK GLASS + GRIME STACK
   ========================= */
.crtGlassLayer{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 20;

  background:
    radial-gradient(circle at 18% 18%,
      rgba(255,255,255,0.16),
      rgba(255,255,255,0.00) 42%),
    linear-gradient(115deg,
      rgba(255,255,255,0.10) 0%,
      rgba(255,255,255,0.03) 22%,
      rgba(255,255,255,0.00) 45%,
      rgba(255,255,255,0.06) 68%,
      rgba(255,255,255,0.00) 100%),
    radial-gradient(circle at 50% 50%,
      rgba(0,0,0,0.00) 55%,
      rgba(0,0,0,0.22) 78%,
      rgba(0,0,0,0.55) 100%);

  opacity: var(--glass);
  mix-blend-mode: screen;
  filter: blur(0.25px) contrast(1.02);
}

/* If you add PNG overlays later (optional) */
.crtImageGrime{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 21;
  background: url("assets/overlays/grime.png") center / cover no-repeat;
  opacity: 0.42;
  mix-blend-mode: screen;
  filter: blur(0.25px) contrast(1.06) brightness(1.08);
}
.crtImageDust{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 22;
  background: url("assets/overlays/dust.png") center / 900px auto repeat;
  opacity: 0.24;
  mix-blend-mode: overlay;
  animation: dustFloat 9.5s linear infinite;
}
@keyframes dustFloat{
  0%{ transform: translate3d(0,0,0); }
  100%{ transform: translate3d(-18px, 12px, 0); }
}

/* CSS grime (works immediately) */
.crtSmudgeLayer{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 23;

  background:
    radial-gradient(180px 140px at 18% 22%, rgba(255,255,255,0.10), rgba(255,255,255,0.00) 70%),
    radial-gradient(220px 160px at 72% 28%, rgba(255,255,255,0.08), rgba(255,255,255,0.00) 72%),
    radial-gradient(260px 200px at 55% 72%, rgba(255,255,255,0.06), rgba(255,255,255,0.00) 76%),
    radial-gradient(160px 120px at 84% 78%, rgba(255,255,255,0.05), rgba(255,255,255,0.00) 70%);

  filter: blur(0.75px);
  mix-blend-mode: screen;
  opacity: calc(0.55 * var(--grime));
}

.crtDustLayer{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 24;

  background-image:
    radial-gradient(rgba(255,255,255,0.08) 1px, transparent 1px),
    radial-gradient(rgba(255,255,255,0.04) 1px, transparent 1px),
    linear-gradient(to bottom,
      rgba(255,255,255,0.02),
      rgba(0,0,0,0) 18%,
      rgba(0,0,0,0) 82%,
      rgba(0,0,0,0.06));

  background-size: 120px 120px, 220px 220px, 100% 100%;
  background-position: 0 0, 60px 30px, 0 0;

  opacity: calc(0.30 * var(--dust));
  animation: dustDrift 7s linear infinite;
  mix-blend-mode: screen;
}
@keyframes dustDrift{
  0%{ transform: translate3d(0,0,0); }
  100%{ transform: translate3d(-16px, 10px, 0); }
}

.crtNoiseLayer{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 25;

  background:
    repeating-linear-gradient(0deg,
      rgba(255,255,255,0.02),
      rgba(255,255,255,0.02) 1px,
      rgba(0,0,0,0) 2px,
      rgba(0,0,0,0) 4px);

  opacity: var(--noise);
  mix-blend-mode: overlay;
  animation: noiseShift 1.8s steps(2) infinite;
}
@keyframes noiseShift{
  0%{ transform: translateY(0); }
  100%{ transform: translateY(4px); }
}

.crtVignetteLayer{
  position:absolute;
  inset:0;
  border-radius: var(--screenRadius);
  pointer-events:none;
  z-index: 26;

  background: radial-gradient(circle at 50% 52%,
    rgba(0,0,0,0.0) 45%,
    rgba(0,0,0,0.45) 78%,
    rgba(0,0,0,0.82) 100%);

  opacity: var(--vignette);
  mix-blend-mode: multiply;
}

/* =========================
   Responsive
   ========================= */
@media (max-width:720px){
  #inputBox{width:100%;}
  #crt{ padding:16px; }
  #screen{ padding: 14px; }
}