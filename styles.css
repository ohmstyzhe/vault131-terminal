:root{
  --g:#4cff9a;
  --bg:#000;

  /* Screen geometry */
  --crt-radius: 26px;        /* outer CRT frame rounding */
  --screen-radius: 22px;     /* glass rounding */
  --bezel: 18px;             /* thickness of bezel padding */
  --screen-ar: 4 / 3;        /* CRT-ish shape (change to 1 / 1 if you truly want square) */
}

/* ============ BASE ============ */
*{ box-sizing:border-box; }

html, body{
  margin:0;
  height:100%;
  background: var(--bg);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;

  /* IMPORTANT: allow scrolling again */
  overflow:auto;
}

body{
  min-height: 100%;
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 18px;
}

/* ============ CRT FRAME (the box) ============ */
#crt{
  width: min(92vw, 980px);
  /* this keeps it from getting tiny or stretched on iPad */
  max-width: 980px;

  background: #070b09;
  border-radius: var(--crt-radius);
  padding: var(--bezel);
  border: 2px solid rgba(255,255,255,0.06);

  box-shadow:
    0 20px 80px rgba(0,0,0,0.65),
    0 0 0 1px rgba(0,0,0,0.65) inset,
    0 0 40px rgba(76,255,154,0.12);

  position:relative;
}

/* ============ GLASS SCREEN (everything lives inside here) ============ */
#screen{
  /* pick your CRT shape */
  aspect-ratio: var(--screen-ar);

  /* avoid weird stretch: keep within viewport */
  width: 100%;
  max-height: min(82vh, 760px);

  background: #050a07;
  border-radius: var(--screen-radius);
  position:relative;
  overflow:hidden;

  padding: 18px 18px 16px;

  /* thick-glass illusion: edge darkness + inner lip */
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.05),
    inset 0 0 28px rgba(0,0,0,0.75),
    inset 0 0 140px rgba(0,0,0,0.90);

  /* subtle curvature vibe WITHOUT breaking layout */
  transform: translateZ(0);
}

/* Optional subtle “warp” on supported browsers.
   If it causes issues on your device, set this to `none`. */
#screen{
  filter: url(#crt-warp);
}

/* ============ HEADER ============ */
#uiWrap{
  margin-bottom:10px;
  padding-bottom:10px;
  border-bottom:1px solid rgba(76,255,154,0.30);
}

#uiTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}

#uiBar{
  color:var(--g);
  font-size:14px;
  letter-spacing:1px;
  opacity:0.92;
}

#uiStatus{
  margin-top:6px;
  color:rgba(76,255,154,0.85);
  font-size:12px;
  letter-spacing:0.8px;
  opacity:0.9;
}

/* ============ TERMINAL ============ */
#terminal{
  /* let terminal be the scrolling region */
  height: calc(100% - 110px);
  overflow-y:auto;
  overflow-x:hidden;

  color:var(--g);
  text-shadow:
    0 0 4px rgba(76,255,154,0.70),
    0 0 10px rgba(76,255,154,0.35);

  white-space:pre-wrap;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;

  /* subtle softness like phosphor bloom */
  filter: contrast(1.03) saturate(1.02);
}

/* ============ INPUT ============ */
#inputBox{
  display:none;
  width:100%;
  margin-top:10px;
  background:rgba(0,0,0,0.55);
  color:var(--g);
  border:2px solid rgba(76,255,154,0.65);
  padding:10px;
  border-radius:12px;
  font-size:16px;
  outline:none;

  box-shadow:
    0 0 0 1px rgba(0,0,0,0.8) inset,
    0 0 14px rgba(76,255,154,0.10);
}

/* HINTS */
#hintContainer{
  margin-top:6px;
  display:flex;
  flex-wrap:wrap;
  gap:6px;
}

/* CURSOR */
#cursor{
  display:inline-block;
  width:10px;
  background:var(--g);
  margin-left:2px;
  animation: blink 1s infinite;
}
@keyframes blink{50%{opacity:0;}}

/* ============ BUTTONS (iOS fix) ============ */
#crt button{
  -webkit-appearance:none;
  appearance:none;
  background:rgba(0,0,0,0.12);
  color:var(--g);
  border:2px solid rgba(76,255,154,0.55);
  border-radius:12px;
  padding:10px 14px;
  cursor:pointer;

  font:inherit;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;

  box-shadow:
    0 0 0 1px rgba(0,0,0,0.75) inset,
    0 0 18px rgba(76,255,154,0.10);

  transition: box-shadow .15s ease, border-color .15s ease, transform .08s ease, filter .15s ease;
}

#crt button:hover,
#crt button:focus-visible{
  border-color: rgba(76,255,154,0.95);
  box-shadow:
    0 0 22px rgba(76,255,154,0.16),
    inset 0 0 12px rgba(76,255,154,0.08);
  filter: brightness(1.10);
}

#crt button:active{ transform: translateY(1px); }
#crt button:disabled{ opacity:0.45; cursor:default; box-shadow:none; }
#crt button:focus{ outline:none; }

/* ============ POWER DIP (keep your existing class trigger) ============ */
#powerDip{
  position:absolute;
  inset:0;
  background: radial-gradient(circle at 50% 45%,
    rgba(76,255,154,0.10),
    rgba(0,0,0,0.92) 60%,
    rgba(0,0,0,0.98) 100%);
  opacity:0;
  pointer-events:none;
  z-index: 50;
  mix-blend-mode: screen;
}
.powerDipOn{ animation: dip 420ms ease-in-out 1; }
@keyframes dip{
  0%{opacity:0; filter:brightness(1) contrast(1);}
  20%{opacity:0.9; filter:brightness(0.65) contrast(1.25);}
  55%{opacity:0.35; filter:brightness(0.85) contrast(1.15);}
  100%{opacity:0; filter:brightness(1) contrast(1);}
}

/* ============ SCANLINES (subtle) ============ */
#scanlines{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index: 40;

  background: repeating-linear-gradient(
    to bottom,
    rgba(0,0,0,0.22),
    rgba(0,0,0,0.22) 1px,
    rgba(0,0,0,0.00) 2px,
    rgba(0,0,0,0.00) 4px
  );

  opacity: 0.55;
  mix-blend-mode: overlay;
}

/* =========================================================
   DISGUSTING THRIFT-STORE GLASS STACK (REALISM)
   ========================================================= */

/* 1) Vignette + corner crush + slight “tube falloff” */
.crtVignetteLayer{
  position:absolute;
  inset:-2px;
  pointer-events:none;
  z-index: 60;

  background:
    radial-gradient(circle at 50% 40%,
      rgba(255,255,255,0.08),
      rgba(0,0,0,0.00) 40%),
    radial-gradient(circle at 50% 55%,
      rgba(0,0,0,0.00) 38%,
      rgba(0,0,0,0.42) 78%,
      rgba(0,0,0,0.88) 100%),
    /* corner darkening to “sell” curvature */
    radial-gradient(circle at 0% 0%,
      rgba(0,0,0,0.55),
      rgba(0,0,0,0.00) 45%),
    radial-gradient(circle at 100% 0%,
      rgba(0,0,0,0.55),
      rgba(0,0,0,0.00) 45%),
    radial-gradient(circle at 0% 100%,
      rgba(0,0,0,0.55),
      rgba(0,0,0,0.00) 45%),
    radial-gradient(circle at 100% 100%,
      rgba(0,0,0,0.55),
      rgba(0,0,0,0.00) 45%);

  opacity: 0.95;
}

/* 2) Glass reflections + thick edge highlight */
.crtGlassLayer{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index: 70;

  background:
    /* top-left reflection sweep */
    radial-gradient(140% 90% at 20% 10%,
      rgba(255,255,255,0.16),
      rgba(255,255,255,0.00) 40%),
    /* mid sheen */
    radial-gradient(120% 80% at 55% 45%,
      rgba(255,255,255,0.06),
      rgba(255,255,255,0.00) 55%),
    /* edge brightening like thick glass */
    radial-gradient(120% 120% at 50% 50%,
      rgba(255,255,255,0.00) 58%,
      rgba(255,255,255,0.05) 74%,
      rgba(255,255,255,0.00) 88%);

  mix-blend-mode: screen;
  opacity: 0.70;
  filter: blur(0.2px);
}

/* 3) Smudges / fingerprints (procedural) */
.crtSmudgeLayer{
  position:absolute;
  inset:-10%;
  pointer-events:none;
  z-index: 80;

  background:
    radial-gradient(circle at 18% 28%,
      rgba(255,255,255,0.10),
      rgba(255,255,255,0.00) 48%),
    radial-gradient(circle at 72% 36%,
      rgba(255,255,255,0.08),
      rgba(255,255,255,0.00) 52%),
    radial-gradient(circle at 62% 82%,
      rgba(255,255,255,0.10),
      rgba(255,255,255,0.00) 54%),
    radial-gradient(circle at 30% 76%,
      rgba(255,255,255,0.06),
      rgba(255,255,255,0.00) 55%),
    /* greasy swipe */
    linear-gradient(110deg,
      rgba(255,255,255,0.00) 20%,
      rgba(255,255,255,0.05) 45%,
      rgba(255,255,255,0.00) 70%);

  opacity: 0.18;
  filter: blur(0.8px) contrast(1.05);
  mix-blend-mode: screen;
}

/* 4) Dust specks + grit */
.crtDustLayer{
  position:absolute;
  inset:0;
  pointer-events:none;
  z-index: 90;

  background-image:
    radial-gradient(rgba(255,255,255,0.05) 1px, transparent 1px),
    radial-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
    radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px);

  background-size:
    140px 140px,
    260px 260px,
    420px 420px;

  background-position:
    0 0,
    60px 30px,
    120px 110px;

  opacity: 0.22;
  animation: dustDrift 9s linear infinite;
}

@keyframes dustDrift{
  0%{ transform: translate3d(0,0,0); }
  100%{ transform: translate3d(-18px, 14px, 0); }
}

/* 5) Subtle moving noise (makes it feel “alive”) */
.crtNoiseLayer{
  position:absolute;
  inset:-12%;
  pointer-events:none;
  z-index: 100;

  background:
    repeating-linear-gradient(
      0deg,
      rgba(255,255,255,0.00) 0px,
      rgba(255,255,255,0.00) 2px,
      rgba(255,255,255,0.02) 3px
    );

  opacity: 0.08;
  mix-blend-mode: overlay;
  animation: noiseShift 0.9s steps(2) infinite;
}

@keyframes noiseShift{
  0%{ transform: translate3d(0,0,0); }
  100%{ transform: translate3d(-6px, 4px, 0); }
}

/* ============ RESPONSIVE ============ */
@media (max-width: 720px){
  body{ padding: 12px; }
  #crt{ width: 96vw; padding: 14px; }
  #screen{ padding: 14px 14px 12px; }
  #uiBar{ font-size: 13px; }
}